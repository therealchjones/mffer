<!DOCTYPE html>
<html>

	<head>
		<base target="_top">
		<title>Marvel Future Fight</title>
		<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
		<link rel="stylesheet" href="https://code.jquery.com/mobile/1.5.0-rc1/jquery.mobile-1.5.0-rc1.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">
		</script>
		<script src="https://code.jquery.com/mobile/1.5.0-rc1/jquery.mobile-1.5.0-rc1.min.js">
		</script>
	</head>

	<body>
		<div class="sidebar">
			<h2>Contents</h2>
			<ul>
				<li><a id="Characters" class="sheet">Characters</a></li>
				<li><a id="Shadowland Calculator" class="sheet">Shadowland</a>
				</li>
				<li><a id="Custom Gear/CTP Stats" class="sheet">Custom
						Gear/CTPs</a></li>
				<li><a id="Heroic Quests" class="sheet">Heroic Quests</a>
					<ul id="Heroic Quests-TOC" class="toc" style="display:none">
						<li><a id="Arachknight">Arachknight</a></li>
						<li><a id="Jessica Jones">Jessica Jones</a></li>
						<li><a id="Luke Cage">Luke Cage</a></li>
						<li><a id="White Fox">White Fox</a></li>
						<li><a id="Wave">Wave</a></li>
						<li><a id="Iron Fist">Iron Fist</a></li>
					</ul>
				<li><a id="Goals / Rewards" class="sheet">Goals &amp;
						Rewards</a></li>
				<li><a id="Crystal Packages for $ / Spending" class="sheet">Spending</a></li>
				<li><a id="Comic Card Calculator" class="sheet">Comic Cards</a>
				</li>
			</ul>
		</div>
	</body>
	<script>
		var pages = document.getElementsByTagName("a");
		var i;
		for (i = 0; i < pages.length; i++) {
			pages[i].onclick = function () {
				var id = this.id;
				if (this.className == "sheet") {
					// activate the appropriate sheet
					google.script.run.activateSheet(id);
					google.script.host.editor.focus();
					// collapse all sub-TOCs
					var tocs = document.getElementsByClassName("toc");
					for (j = 0; j < tocs.length; j++) {
						tocs[j].style.display = "none";
					}
					// expand the appropriate sub-TOC if exists
					var toc = document.getElementById(id + "-TOC");
					if (toc) {
						toc.style.display = "block";
					}
				} else {
					// for sub-sheets, link to appropriate cell
					var sheet = this.parentElement.id.replace(/-TOC$/, "");
					google.script.run.activateSheet(sheet);
					// need to do the following as a success handler or it will happen too early (or use different function)
					google.script.run.activateSection(id);
					google.script.host.editor.focus();
				}
			}
		}

	</script>

</html>
